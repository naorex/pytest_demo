## アプリ開発におけるテスト

以下の種類あり。

- 単体テスト
  - テストが可能さ最小単位（関数・メソッド）で動作を確認
- システムテスト
  - 実際の使用を想定した一連の処理
- セキュリティテスト
  - システムの脆弱性の有無確認
- 性能テスト
  - システムに必要な性能を満たしているかの確認
- リグレッションテスト
  - システムの変更後に意図しない変更が含まれない事を確認

## まずは単体テストから

テストコードを使ってアプリに含まれるコードを動かし、想定通りの結果になるかを確認する一連の作業。
理想的にはすべてのコードに対してテストコードを書くべきだが、現実的には優先順位を付けてテストコードを書く。

サンプルのフォルダ階層

```text
src
├ __init__.py  // -> このディレクトリがパッケージである事を明示するためだけのファイル
├ module_1.py
└ module_2.py
tests
├ __init__.py
├ test_module_1.py
└ test_module_2.py
```

基本的には **test\_.py** や **\_test.py** という名称が付くファイルを探して全て実行する仕様。

## fixture を使って事前処理・事後処理

テストで共通の事前処理や事後処理を行いたい場合は fixture 機能を使う事でテスト前後に処理を挟み込む事が出来る。

デコレータを使う事で記述を省略できるようになる。

また、`return` の代わりに `yield` を使う事で、事前処理と事後処理を明示的に分けられる。

## 自作関数をモックに置き換える

モックとはテスト用のダミープログラムの事。本来の呼び出し先が使えない状況でモックでテストを行う。

`fixture` の一部である `monkeypatch` を使う。オブジェクトの属性や環境変数などを差し替える機能を提供してくれる。

## 外部関数をモックに置き換える

同様に `monkeypatch` を使う

## その他

テストコード内の print 出力結果を見るオプション

```bash
pytest -s
```
